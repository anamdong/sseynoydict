# sseynoydict

広韻系のような「声母 + 開合 + 等 + 韻名 + 声調 + 字リスト」を含むテキストから、各漢字の字音情報を抽出し、内部定義のローマ字体系で **字 → 読み（roman/ipa）** を生成・表示するローカル完結アプリです。

---

## できること

- 体系テキスト（JSONまたはテキスト）を読み込んで、漢字ごとの音韻情報（init / rime / tone）を参照できる
- **Roman モード**：`initial + rime + tone` を合成してローマ字出力
- **IPA モード**：エントリに `ipa` がある場合はそれを表示
- ローマ字合成後に、**glide削除・核母音判定・濁音による母音変換・声調記号付与**などの後処理を実施

---

## 想定する入力（字音体系）

アプリは内部で、各漢字に対して最低限次の情報を持つ体系を扱います。

- `init`：声母（例：幫・滂…に相当するキーでも、すでにローマ字でもOK）
- `rime`：韻（内部辞書で引けるキー、または直接ローマ字でもOK）
- `tone`：声調（例：平/上/去/入、あるいは A/B/C 等でもOK）
- `ipa`：（任意）IPA表示用

### 最小JSON例

```json
{
  "entries": {
    "音": { "init": "x", "rime": "ya", "tone": "C", "ipa": "ɕja" }
  },
  "roman": {
    "initials": { "x": "x" },
    "rimes": { "ya": "ya" },
    "tones": { "C": "ˇ" }
  }
}
````

---

## 使い方

1. 左ペインに体系JSONを貼り付ける（またはサンプルをロード）
2. **解析**を押して体系を読み込む
3. 右ペインの入力欄に漢字を入力（複数文字OK）
4. `roman / ipa` を選んで **変換** を押す

---

## 出力

### Roman モード

* `initialRoman + rimeRoman + toneMark` を連結した文字列を出力します。
* 例（概念）：

  * 入力：`音`
  * 出力：`x + a + ˇ` → `xaˇ`（※ tone 表示方式は体系側の `roman.tones` に依存）

### IPA モード

* エントリに `ipa` があればそれを出力します（なければ `<?>` などのプレースホルダ）。

### 付随表示（UI）

* 最後に変換された字の `initial / rime / tone / raw entry` を表示（デバッグ用）

---

## 変換処理の流れ（Roman）

Roman 表示は、概ね次の順に処理されます。

1. **initialの変換**

   * `entry.init` を `roman.initials` でローマ字へ

2. **rimeの変換**

   * `entry.rime` を `roman.rimes` でローマ字へ

3. **glide・音節整形（後処理）**

   * 「核母音（nucleus）」を推定し、先頭の `y/i/u/w` が **glide（滑音）**かどうかを判定して削除します。
   * 既存の処理例：

     * `b/p/m` の後の `w-` glide削除
     * `b/p/m` の後の `y-` glide削除
     * `w/f` の後の `y-` glide削除
     * `w` の後の `u-` glide削除（核なら残す）
     * `y` の後の `i-` glide削除（核なら残す）
     * など

4. **（追加ルール）init=x の後の y- glide のみ削除**

   * 条件：`initialRoman === "x"` かつ `rimeRoman` が `y` で始まる
   * 動作：`y` が **核母音ではなくglide** と判定された場合のみ `y` を削除
   * ※ `y` が主母音（核）なら削除しません。

5. **声調記号の付与**

   * `roman.tones[tone]` を語末に付与（実装は体系定義に依存）
   * または（別実装の場合）核母音に結合記号を付ける方式

---

## glide / 核母音（nucleus）の考え方

* アプリ内関数が、rime文字列中の「最初の母音（あるいは母音群）」を核母音候補として検出します。
* `y/i/u/w` が先頭にあっても、それが核母音より前に位置する場合は **glide** とみなされ、状況に応じて削除されます。

> 体系によって `y` を母音として扱う・扱わない、`iu` を二重母音として扱う、などの流儀が変わるため、核母音判定はこのアプリの「定義」に基づく近似です。必要に応じて `extractNucleus()` の規則を調整してください。

---

## カスタマイズ

* **ローマ字体系を変えたい**

  * `roman.initials / roman.rimes / roman.tones` を差し替えてください。
* **glide削除規則を変えたい**

  * `romanize()` 内の後処理ブロック（glide削除）を追加・変更してください。
* **核母音の判定基準を変えたい**

  * `extractNucleus()` を編集してください（ここが glide 判定の根拠になります）。

---

## 注意点 / 制限

* このアプリは **ローカル完結**（ブラウザ内で処理）を前提にしています。
* 体系のキーやフォーマットは「このHTML内の変換ロジック」に依存します。

  * `init/rime/tone` のキー名が異なる体系を使う場合は、読み取り側（`getEntry()` や `romanize()`）を合わせてください。

---

## ライセンス

* （必要なら追記してください）

```

必要なら、この README に **「変換例（入力→出力の実例）」** を3〜5個付けて、仕様が一発で伝わる版にも整形します。
```
